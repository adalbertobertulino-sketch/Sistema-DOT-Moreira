<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sistema DOT Moreira — Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="topbar">
    <div class="brand">Sistema DOT Moreira — Dashboard</div>
    <div style="display:flex;align-items:center;gap:10px">
      <span id="badgeRole" class="badge">Carregando…</span>
      <button id="btnSair" class="btn btn-ghost">Sair</button>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <h1 class="h1" id="welcome">Carregando…</h1>
      <div class="small" id="who"></div>

      <div id="notice" class="notice" style="display:none;margin-top:12px"></div>

      <div class="nav" style="margin-top:12px">
        <a href="#" data-tab="inicio" class="active">Início</a>
        <a href="#" data-tab="turmas">Turmas</a>
        <a href="#" data-tab="alunos">Alunos</a>
        <a href="#" data-tab="avisos">Avisos DOT</a>
      </div>
    </div>

    <div class="grid">
      <!-- COLUNA PRINCIPAL -->
      <div class="card">
        <!-- INÍCIO -->
        <section id="tab-inicio">
          <h2 style="margin:0 0 8px 0">Painel</h2>
          <div class="small">Dados em tempo real (Firestore)</div>

          <div class="kpis">
            <div class="kpi">
              <div class="kpi-num" id="kpiTurmas">—</div>
              <div class="kpi-lbl">Turmas</div>
            </div>
            <div class="kpi">
              <div class="kpi-num" id="kpiAlunos">—</div>
              <div class="kpi-lbl">Alunos</div>
            </div>
            <div class="kpi">
              <div class="kpi-num" id="kpiAvisos">—</div>
              <div class="kpi-lbl">Avisos</div>
            </div>
          </div>

          <hr/>

          <div class="small">Últimos avisos</div>
          <div class="list" id="listAvisosResumo"></div>
        </section>

        <!-- TURMAS -->
        <section id="tab-turmas" style="display:none">
          <h2 style="margin:0 0 8px 0">Turmas</h2>
          <div class="small">Admin cria/edita. Usuário DOT só visualiza.</div>

          <div id="formTurma" style="display:none; margin-top:12px">
            <hr/>
            <h3 style="margin:0 0 8px 0">Cadastrar turma</h3>
            <div class="row">
              <div class="field">
                <label>Nome da turma</label>
                <input id="turmaNome" placeholder="Ex.: 1º Ano A" />
              </div>
              <div class="field">
                <label>Ano</label>
                <input id="turmaAno" placeholder="Ex.: 2026" />
              </div>
            </div>
            <button id="btnSalvarTurma" class="btn btn-primary" style="margin-top:10px">
              Salvar turma
            </button>
            <div class="small" id="turmaMsg" style="margin-top:8px"></div>
          </div>

          <hr/>
          <div class="list" id="listTurmas"></div>
        </section>

        <!-- ALUNOS -->
        <section id="tab-alunos" style="display:none">
          <h2 style="margin:0 0 8px 0">Alunos</h2>
          <div class="small">Admin cadastra e escolhe a turma. Usuário DOT só visualiza.</div>

          <div id="formAluno" style="display:none; margin-top:12px">
            <hr/>
            <h3 style="margin:0 0 8px 0">Cadastrar aluno</h3>
            <div class="row">
              <div class="field">
                <label>Nome do aluno</label>
                <input id="alunoNome" placeholder="Nome completo" />
              </div>
              <div class="field">
                <label>Turma</label>
                <select id="alunoTurma">
                  <option value="">Carregando turmas…</option>
                </select>
              </div>
            </div>
            <button id="btnSalvarAluno" class="btn btn-primary" style="margin-top:10px">
              Salvar aluno
            </button>
            <div class="small" id="alunoMsg" style="margin-top:8px"></div>
          </div>

          <hr/>
          <div class="list" id="listAlunos"></div>
        </section>

        <!-- AVISOS -->
        <section id="tab-avisos" style="display:none">
          <h2 style="margin:0 0 8px 0">Avisos DOT</h2>
          <div class="small">Admin publica avisos. Usuário DOT visualiza.</div>

          <div id="formAviso" style="display:none; margin-top:12px">
            <hr/>
            <h3 style="margin:0 0 8px 0">Publicar aviso</h3>
            <div class="row">
              <div class="field">
                <label>Título</label>
                <input id="avisoTitulo" placeholder="Ex.: Reunião pedagógica" />
              </div>
              <div class="field">
                <label>Data</label>
                <input id="avisoData" type="date" />
              </div>
            </div>
            <div class="field" style="margin-top:10px">
              <label>Texto</label>
              <textarea id="avisoTexto" placeholder="Escreva o aviso..."></textarea>
            </div>
            <button id="btnSalvarAviso" class="btn btn-primary" style="margin-top:10px">
              Publicar aviso
            </button>
            <div class="small" id="avisoMsg" style="margin-top:8px"></div>
          </div>

          <hr/>
          <div class="list" id="listAvisos"></div>
        </section>
      </div>

      <!-- COLUNA LATERAL -->
      <div class="card">
        <h2 style="margin:0 0 8px 0">Perfil</h2>
        <div class="small" id="perfilBox">Carregando…</div>

        <hr/>

        <div class="notice" id="debugBox" style="display:none"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import { startDashboardPage } from "./app.js";
    startDashboardPage();
  </script>
</body>
</html>
